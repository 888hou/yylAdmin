import{c as t,l as e,w as a,k as i,O as s,e as n,Q as o,af as r,a3 as l,t as d,an as h}from"./index.APvhMgDH.js";import{v as p}from"./el-loading.IVadhBA1.js";import{E as c}from"./el-scrollbar.BRsHK0Jh.js";import{E as m}from"./el-date-picker.D6McR6zP.js";import"./el-popper.BGF08XMW.js";import{a as g,E as _}from"./el-select.DcB9YoAC.js";import{E as u}from"./el-row.CPP9k-Sk.js";import{E as f}from"./el-col.CfjMTi8p.js";import{E as y}from"./el-card.AzeQmgCv.js";import{E as x}from"./el-statistic.CkULn5eN.js";import{s as k}from"./screen-height.C1I3e_dh.js";import{s as w}from"./member.Yn91P2hx.js";import{_ as j}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{u as v,i as D,a as C,b as M,c as b}from"./installCanvasRenderer.BU9Xfj2q.js";import{i as E,a as Y}from"./install.Be7BgDCX.js";import{i as T,a as $}from"./install.6My4tGJu.js";import{i as V}from"./install.8F3SWQ07.js";import"./debounce.DkHeVxem.js";import"./index.DWtrYHhd.js";import"./isUndefined.DgmxjSXK.js";import"./_Uint8Array.Dyjbn1zu.js";import"./castArray.BGOR1owe.js";import"./tagsView.CbCSAniL.js";v([E,T,D,V,$,C,Y,M]);const O={class:"app-container"},A={class:"text-center"},S=["title"],U=["id"];const I=j({name:"MemberStatistic",data:()=>({name:"会员统计",height:680,loading:!1,count:[],echart_id:"echartid",echart_num:1,echart_data:[],date_type:"day",date_range:[],date_options:{},date_ptype:"monthrange",date_format:"YYYY-MM",picker_options_day:{shortcuts:[{text:"最近7天",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-5184e5),t.$emit("pick",[a,e])}},{text:"最近30天",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-25056e5),t.$emit("pick",[a,e])}},{text:"最近90天",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-76896e5),t.$emit("pick",[a,e])}},{text:"最近120天",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-102816e5),t.$emit("pick",[a,e])}}]},picker_options_month:{shortcuts:[{text:"最近3个月",onClick(t){const e=new Date,a=new Date;a.setMonth(a.getMonth()-2),t.$emit("pick",[a,e])}},{text:"最近6个月",onClick(t){const e=new Date,a=new Date;a.setMonth(a.getMonth()-5),t.$emit("pick",[a,e])}},{text:"最近9个月",onClick(t){const e=new Date,a=new Date;a.setMonth(a.getMonth()-8),t.$emit("pick",[a,e])}},{text:"最近12个月",onClick(t){const e=new Date,a=new Date;a.setMonth(a.getMonth()-11),t.$emit("pick",[a,e])}}]}}),watch:{echart_data(){this.$nextTick((()=>{this.setEchart()}))}},created(){this.height=k(140),this.statistic()},methods:{statistic(){this.loading=!0,w({type:this.date_type,date:this.date_range}).then((t=>{this.count=t.data.count,this.echart_data=t.data.echart,this.echart_num=t.data.echart.length,this.dateOptions(),this.loading=!1})).catch((()=>{this.loading=!1}))},typeChange(){this.dateOptions(),this.date_range=[]},dateOptions(){const t=this.date_type;"day"===t?(this.date_ptype="daterange",this.date_format="YYYY-MM-DD",this.date_options=this.picker_options_day):"month"===t&&(this.date_ptype="monthrange",this.date_format="YYYY-MM",this.date_options=this.picker_options_month)},dateChange(){this.statistic()},setEchart(){const t=this.echart_data,e=this.echart_num,a=this.echart_id;for(let i=0;i<e;i++)this.initEchart(t[i],a+i),this.date_type=t[i].type,this.date_range=t[i].date},initEchart(t,e){var a=b(document.getElementById(e)),i={title:{text:t.title,textStyle:{fontSize:12}},legend:{top:"20px",data:t.legend,selected:{"总数":!1}},grid:{top:"80px",left:"1%",right:"3%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:t.xAxis},yAxis:{type:"value"},tooltip:{trigger:"axis",textStyle:{align:"left"}},toolbox:{feature:{magicType:{show:!0,type:["line","bar"]},dataView:{show:!0,readOnly:!0},saveAsImage:{show:!0,name:this.name+t.date[0]+"-"+t.date[1]}}},series:t.series};a.setOption(i)}}},[["render",function(k,w,j,v,D,C){const M=x,b=y,E=f,Y=u,T=g,$=_,V=m,I=c,Q=p;return t(),e(I,{native:"",height:D.height},{default:a((()=>[i("div",O,[s((t(),e(Y,{gutter:10},{default:a((()=>[(t(!0),n(o,null,r(D.count,((s,n)=>(t(),e(E,{key:n,xs:24,span:3},{default:a((()=>[l(b,{"body-style":{padding:"10px 0px"}},{header:a((()=>[i("div",A,[i("span",null,d(s.name),1)])])),default:a((()=>[i("div",{class:"text-center",title:s.title},[l(M,{value:s.count},null,8,["value"])],8,S)])),_:2},1024)])),_:2},1024)))),128))])),_:1})),[[Q,D.loading]]),(t(!0),n(o,null,r(D.echart_num,((n,o)=>s((t(),e(b,{key:o,class:"mt-[10px]"},{default:a((()=>[l(Y,{class:"text-center"},{default:a((()=>[l(E,null,{default:a((()=>[l($,{modelValue:D.date_type,"onUpdate:modelValue":w[0]||(w[0]=t=>D.date_type=t),class:"!w-[100px]",onChange:C.typeChange},{default:a((()=>[l(T,{label:"日",value:"day"}),l(T,{label:"月",value:"month"})])),_:1},8,["modelValue","onChange"]),l(V,{modelValue:D.date_range,"onUpdate:modelValue":w[1]||(w[1]=t=>D.date_range=t),type:D.date_ptype,"value-format":D.date_format,"picker-options":D.date_options,"start-placeholder":"开始日期","end-placeholder":"结束日期",onChange:C.dateChange},null,8,["modelValue","type","value-format","picker-options","onChange"])])),_:1}),l(E,null,{default:a((()=>[i("div",{id:D.echart_id+o,style:h({height:D.height-300+"px"})},null,12,U)])),_:2},1024)])),_:2},1024)])),_:2},1024)),[[Q,D.loading]]))),128))])])),_:1},8,["height"])}]]);export{I as default};
