import{ab as e,ac as l,a as t,c as a,a3 as i,w as s,Q as o,af as d,k as r,a2 as m,j as u,t as n,aa as c,O as p,an as h,P as _,ay as f,as as g}from"./index.Dxpxc0Wv.js";import{v as b}from"./el-loading.BCiGpebW.js";import{E as y,a as V}from"./el-tab-pane.Da98a0W4.js";import{_ as v}from"./index.BCHZaZkb.js";import{E as k}from"./el-scrollbar.BKnRmybh.js";import{E as j}from"./el-color-picker.B-NFRDrN.js";import{_ as w}from"./index.B2i032k8.js";import{a as q,b as U}from"./el-table-column.BNhG6A-T.js";import"./el-tooltip.l0sNRNKZ.js";import"./el-popper.BLXyGuOS.js";import{E as x}from"./el-link.258Xj9Py.js";import{_ as C}from"./FileImage.BIabG5Hq.js";import{a as D,E as Y}from"./el-select.BU8tiYSJ.js";import{E as T}from"./el-dialog.C5oj6JW_.js";import{a as I,E}from"./el-form-item.BmMa_aL_.js";import{E as H}from"./el-switch.Ebb2GB46.js";import{E as S}from"./el-row.zIhwjUGa.js";import{E as M}from"./el-col.BYj1fpTj.js";import{_ as $}from"./index.Cbbf_j0e.js";import{E as A}from"./el-date-picker.CCbwDReu.js";import{s as G}from"./screen-height.BK3DmwY2.js";import{a as O}from"./index.Cp1HnnF1.js";import{g as P}from"./settings.U_VcR2t9.js";import{l as z,i as F,e as R,a as B,d as J,b as L,c as N}from"./notice.D3EtBO_U.js";import{_ as Q}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./index.C_cuZU8U.js";import"./FilePreview.DqbXTHyZ.js";import"./el-image-viewer.CDtIut0V.js";import"./debounce.DgKViq2u.js";import"./clipboard.B-1H5DfJ.js";import"./el-card.CRUX5or8.js";import"./el-text.ejFmqdVy.js";/* empty css                       */import"./permission.rRlXuh-w.js";import"./group.DbuoJHrB.js";import"./tag.BvJ8bHp9.js";import"./index.BKBoPrp-.js";import"./index.BwTiryq0.js";import"./_Uint8Array.T21uhEY5.js";import"./isUndefined.DgmxjSXK.js";import"./el-avatar.BE6jY_Ku.js";import"./refs.sW_Fo3zA.js";import"./castArray.BzMl53vD.js";import"./tagsView.CyhALVSk.js";const W={name:"SystemNotice",components:{Pagination:w,RichEditor:v},data:()=>({name:"公告",height:680,loading:!1,idkey:"notice_id",exps:[{exp:"like",name:"包含"}],query:{page:1,limit:P(),search_field:"title",search_exp:"like",date_field:"create_time"},data:[],count:0,dialog:!1,dialogTitle:"",model:{notice_id:"",image_id:0,image_url:"",type:1,title:"",title_color:"",start_time:"",end_time:"",desc:"",content:"",remark:"",sort:250},rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],start_time:[{required:!0,message:"请输入开始时间",trigger:"blur"}],end_time:[{required:!0,message:"请输入结束时间",trigger:"blur"}]},selection:[],selectIds:"",selectTitle:"操作",selectDialog:!1,selectType:"",is_disable:0,start_time:"",end_time:""}),created(){this.height=G(),this.list()},methods:{list(){this.loading=!0,z(this.query).then((e=>{this.data=e.data.list,this.count=e.data.count,this.exps=e.data.exps,this.loading=!1})).catch((()=>{this.loading=!1}))},add(){this.dialog=!0,this.dialogTitle=this.name+"添加",this.reset()},edit(e){this.dialog=!0,this.dialogTitle=this.name+"修改："+e[this.idkey];var l={};l[this.idkey]=e[this.idkey],F(l).then((e=>{this.reset(e.data)})).catch((()=>{}))},cancel(){this.dialog=!1,this.reset()},submit(){this.$refs.ref.validate((l=>{l?(this.loading=!0,this.model[this.idkey]?R(this.model).then((l=>{this.list(),this.dialog=!1,e.success(l.msg)})).catch((()=>{this.loading=!1})):B(this.model).then((l=>{this.list(),this.dialog=!1,e.success(l.msg)})).catch((()=>{this.loading=!1}))):e.error("请完善必填项（带红色星号*）")}))},reset(e){if(this.model=e||this.$options.data().model,void 0!==this.$refs.ref)try{this.$refs.ref.resetFields(),this.$refs.ref.clearValidate()}catch(l){}},search(){this.query.page=1,this.list()},refresh(){const e=this.query.limit;this.query=this.$options.data().query,this.$refs.table.clearSort(),this.query.limit=e,this.list()},sort(e){this.query.sort_field=e.prop,this.query.sort_value="","ascending"===e.order&&(this.query.sort_value="asc",this.list()),"descending"===e.order&&(this.query.sort_value="desc",this.list())},select(e){this.selection=e,this.selectIds=this.selectGetIds(e).toString()},selectGetIds(e){return O(e,this.idkey)},selectAlert(){l.alert("请选择需要操作的"+this.name,"提示",{type:"warning",callback:()=>{}})},selectOpen(e,l=""){if(l){this.$refs.table.clearSelection();const e=l.length;for(let t=0;t<e;t++)this.$refs.table.toggleRowSelection(l[t],!0)}this.selection.length?(this.selectTitle="操作","disable"===e?this.selectTitle=this.name+"是否禁用":"datetime"===e?this.selectTitle=this.name+"时间范围":"dele"===e&&(this.selectTitle=this.name+"删除"),this.selectDialog=!0,this.selectType=e):this.selectAlert()},selectCancel(){this.selectDialog=!1},selectSubmit(){if(this.selection.length){const e=this.selectType;"disable"===e?this.disable(this.selection,!0):"datetime"===e?this.datetime(this.selection):"dele"===e&&this.dele(this.selection),this.selectDialog=!1}else this.selectAlert()},disable(l,t=!1){if(l.length){this.loading=!0;var a=l[0].is_disable;t&&(a=this.is_disable),J({ids:this.selectGetIds(l),is_disable:a}).then((l=>{this.list(),e.success(l.msg)})).catch((()=>{this.list()}))}else this.selectAlert()},datetime(l){l.length?(this.loading=!0,L({ids:this.selectGetIds(l),start_time:this.start_time,end_time:this.end_time}).then((l=>{this.list(),e.success(l.msg)})).catch((()=>{this.loading=!1}))):this.selectAlert()},dele(l){l.length?N({ids:this.selectGetIds(l)}).then((l=>{this.list(),e.success(l.msg)})).catch((()=>{this.loading=!1})):this.selectAlert()}}},K={class:"app-container"},X=u("span",null,"至",-1),Z={class:"c-red"};const ee=Q(W,[["render",function(e,l,G,O,P,z){const F=D,R=Y,B=f,J=A,L=g,N=$,Q=M,W=S,ee=H,le=I,te=E,ae=T,ie=q,se=C,oe=x,de=U,re=w,me=j,ue=k,ne=y,ce=v,pe=V,he=b;return t(),a("div",K,[i(W,null,{default:s((()=>[i(Q,{class:"mb-2"},{default:s((()=>[i(R,{modelValue:P.query.search_field,"onUpdate:modelValue":l[0]||(l[0]=e=>P.query.search_field=e),class:"ya-search-field",placeholder:"查询字段"},{default:s((()=>[i(F,{value:P.idkey,label:"ID"},null,8,["value"]),i(F,{value:"title",label:"标题"}),i(F,{value:"desc",label:"描述"}),i(F,{value:"remark",label:"备注"}),i(F,{value:"is_disable",label:"禁用"})])),_:1},8,["modelValue"]),i(R,{modelValue:P.query.search_exp,"onUpdate:modelValue":l[1]||(l[1]=e=>P.query.search_exp=e),class:"ya-search-exp"},{default:s((()=>[(t(!0),a(o,null,d(P.exps,(e=>(t(),r(F,{key:e.exp,value:e.exp,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"]),"is_disable"===P.query.search_field?(t(),r(R,{key:0,modelValue:P.query.search_value,"onUpdate:modelValue":l[2]||(l[2]=e=>P.query.search_value=e),class:"ya-search-value"},{default:s((()=>[i(F,{value:1,label:"是"}),i(F,{value:0,label:"否"})])),_:1},8,["modelValue"])):(t(),r(B,{key:1,modelValue:P.query.search_value,"onUpdate:modelValue":l[3]||(l[3]=e=>P.query.search_value=e),class:"ya-search-value",placeholder:"查询内容",clearable:""},null,8,["modelValue"])),i(R,{modelValue:P.query.date_field,"onUpdate:modelValue":l[4]||(l[4]=e=>P.query.date_field=e),class:"ya-date-field",placeholder:"时间字段"},{default:s((()=>[i(F,{value:"create_time",label:"添加时间"}),i(F,{value:"update_time",label:"修改时间"}),i(F,{value:"start_time",label:"开始时间"}),i(F,{value:"end_time",label:"结束时间"})])),_:1},8,["modelValue"]),i(J,{modelValue:P.query.date_value,"onUpdate:modelValue":l[5]||(l[5]=e=>P.query.date_value=e),type:"datetimerange",class:"ya-date-value","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD HH:mm:ss","default-time":[new Date(2024,1,1,0,0,0),new Date(2024,1,1,23,59,59)]},null,8,["modelValue","default-time"]),i(L,{type:"primary",onClick:l[6]||(l[6]=e=>z.search())},{default:s((()=>[m("查询")])),_:1}),i(L,{title:"重置",onClick:l[7]||(l[7]=e=>z.refresh())},{default:s((()=>[i(N,{"icon-class":"refresh"})])),_:1}),i(L,{type:"primary",onClick:l[8]||(l[8]=e=>z.add())},{default:s((()=>[m("添加")])),_:1})])),_:1})])),_:1}),i(W,null,{default:s((()=>[i(Q,null,{default:s((()=>[i(L,{title:"删除",onClick:l[9]||(l[9]=e=>z.selectOpen("dele"))},{default:s((()=>[m("删除")])),_:1}),i(L,{title:"是否禁用",onClick:l[10]||(l[10]=e=>z.selectOpen("disable"))},{default:s((()=>[m("禁用")])),_:1}),i(L,{title:"时间范围",onClick:l[11]||(l[11]=e=>z.selectOpen("datetime"))},{default:s((()=>[m("时间")])),_:1})])),_:1})])),_:1}),i(ae,{modelValue:P.selectDialog,"onUpdate:modelValue":l[16]||(l[16]=e=>P.selectDialog=e),title:P.selectTitle,"close-on-click-modal":!1,"close-on-press-escape":!1,top:"20vh"},{footer:s((()=>[i(L,{loading:P.loading,onClick:z.selectCancel},{default:s((()=>[m("取消")])),_:1},8,["loading","onClick"]),i(L,{loading:P.loading,type:"primary",onClick:z.selectSubmit},{default:s((()=>[m("提交")])),_:1},8,["loading","onClick"])])),default:s((()=>[i(te,{ref:"selectRef","label-width":"120px"},{default:s((()=>["disable"===P.selectType?(t(),r(le,{key:0,label:"是否禁用"},{default:s((()=>[i(ee,{modelValue:P.is_disable,"onUpdate:modelValue":l[12]||(l[12]=e=>P.is_disable=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1})):"datetime"===P.selectType?(t(),r(le,{key:1,label:"时间范围"},{default:s((()=>[i(J,{modelValue:P.start_time,"onUpdate:modelValue":l[13]||(l[13]=e=>P.start_time=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss","default-time":new Date(2024,1,1,0,0,0),placeholder:"开始时间"},null,8,["modelValue","default-time"]),X,i(J,{modelValue:P.end_time,"onUpdate:modelValue":l[14]||(l[14]=e=>P.end_time=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss","default-time":new Date(2024,1,1,23,59,59),placeholder:"结束时间"},null,8,["modelValue","default-time"])])),_:1})):"dele"===P.selectType?(t(),r(le,{key:2},{default:s((()=>[u("span",Z,"确定要删除选中的"+n(P.name)+"吗？",1)])),_:1})):c("",!0),i(le,{label:P.name+"ID"},{default:s((()=>[i(B,{modelValue:P.selectIds,"onUpdate:modelValue":l[15]||(l[15]=e=>P.selectIds=e),type:"textarea",autosize:"",disabled:""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},512)])),_:1},8,["modelValue","title"]),p((t(),r(de,{ref:"table",data:P.data,height:P.height,onSortChange:z.sort,onSelectionChange:z.select},{default:s((()=>[i(ie,{type:"selection",width:"42",title:"全选/反选"}),i(ie,{prop:P.idkey,label:"ID",width:"80",sortable:"custom"},null,8,["prop"]),i(ie,{prop:"image_id",label:"图片","min-width":"62"},{default:s((e=>[i(se,{"file-url":e.row.image_url,lazy:""},null,8,["file-url"])])),_:1}),i(ie,{prop:"title",label:"标题","min-width":"220","show-overflow-tooltip":""},{default:s((e=>[u("span",{style:h({color:e.row.title_color})},n(e.row.title),5)])),_:1}),i(ie,{prop:"start_time",label:"开始时间",width:"165",sortable:"custom"}),i(ie,{prop:"end_time",label:"结束时间",width:"165",sortable:"custom"}),i(ie,{prop:"is_disable",label:"禁用","min-width":"85",sortable:"custom"},{default:s((e=>[i(ee,{modelValue:e.row.is_disable,"onUpdate:modelValue":l=>e.row.is_disable=l,"active-value":1,"inactive-value":0,onChange:l=>z.disable([e.row])},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),i(ie,{prop:"sort",label:"排序","min-width":"85",sortable:"custom"}),i(ie,{prop:"create_time",label:"添加时间",width:"165",sortable:"custom"}),i(ie,{prop:"update_time",label:"修改时间",width:"165",sortable:"custom"}),i(ie,{label:"操作",width:"95"},{default:s((e=>[i(oe,{type:"primary",class:"mr-1",underline:!1,onClick:l=>z.edit(e.row)},{default:s((()=>[m(" 修改 ")])),_:2},1032,["onClick"]),i(oe,{type:"primary",underline:!1,onClick:l=>z.selectOpen("dele",[e.row])},{default:s((()=>[m(" 删除 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","height","onSortChange","onSelectionChange"])),[[he,P.loading]]),p(i(re,{total:P.count,"onUpdate:total":l[17]||(l[17]=e=>P.count=e),page:P.query.page,"onUpdate:page":l[18]||(l[18]=e=>P.query.page=e),limit:P.query.limit,"onUpdate:limit":l[19]||(l[19]=e=>P.query.limit=e),onPagination:z.list},null,8,["total","page","limit","onPagination"]),[[_,P.count>0]]),i(ae,{modelValue:P.dialog,"onUpdate:modelValue":l[32]||(l[32]=e=>P.dialog=e),title:P.dialogTitle,"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":z.cancel,top:"5vh"},{footer:s((()=>[i(L,{loading:P.loading,onClick:z.cancel},{default:s((()=>[m("取消")])),_:1},8,["loading","onClick"]),i(L,{loading:P.loading,type:"primary",onClick:z.submit},{default:s((()=>[m("提交")])),_:1},8,["loading","onClick"])])),default:s((()=>[i(te,{ref:"ref",model:P.model,rules:P.rules,"label-width":"100px"},{default:s((()=>[i(pe,null,{default:s((()=>[i(ne,{label:"信息"},{default:s((()=>[i(ue,{native:"",height:P.height-80},{default:s((()=>[i(le,{label:"图片",prop:"image_id"},{default:s((()=>[i(se,{modelValue:P.model.image_id,"onUpdate:modelValue":l[20]||(l[20]=e=>P.model.image_id=e),"file-url":P.model.image_url,height:100,upload:""},null,8,["modelValue","file-url"])])),_:1}),i(le,{label:"标题",prop:"title"},{default:s((()=>[i(Q,{span:18},{default:s((()=>[i(B,{modelValue:P.model.title,"onUpdate:modelValue":l[21]||(l[21]=e=>P.model.title=e),placeholder:"请输入标题",clearable:""},null,8,["modelValue"])])),_:1}),i(Q,{span:3,style:{"text-align":"center"}},{default:s((()=>[m("标题颜色")])),_:1}),i(Q,{span:3},{default:s((()=>[i(me,{modelValue:P.model.title_color,"onUpdate:modelValue":l[22]||(l[22]=e=>P.model.title_color=e)},null,8,["modelValue"])])),_:1})])),_:1}),i(le,{label:"简介",prop:"desc"},{default:s((()=>[i(B,{modelValue:P.model.desc,"onUpdate:modelValue":l[23]||(l[23]=e=>P.model.desc=e),type:"textarea",autosize:"",placeholder:"请输入简介"},null,8,["modelValue"])])),_:1}),i(le,{label:"开始时间",prop:"start_time"},{default:s((()=>[i(J,{modelValue:P.model.start_time,"onUpdate:modelValue":l[24]||(l[24]=e=>P.model.start_time=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss","default-time":new Date(2024,1,1,0,0,0),placeholder:"开始时间"},null,8,["modelValue","default-time"])])),_:1}),i(le,{label:"结束时间",prop:"end_time"},{default:s((()=>[i(J,{modelValue:P.model.end_time,"onUpdate:modelValue":l[25]||(l[25]=e=>P.model.end_time=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss","default-time":new Date(2024,1,1,23,59,59),placeholder:"结束时间"},null,8,["modelValue","default-time"])])),_:1}),i(le,{label:"备注",prop:"remark"},{default:s((()=>[i(B,{modelValue:P.model.remark,"onUpdate:modelValue":l[26]||(l[26]=e=>P.model.remark=e),placeholder:"请输入备注",clearable:""},null,8,["modelValue"])])),_:1}),i(le,{label:"排序",prop:"sort"},{default:s((()=>[i(B,{modelValue:P.model.sort,"onUpdate:modelValue":l[27]||(l[27]=e=>P.model.sort=e),type:"number"},null,8,["modelValue"])])),_:1}),P.model[P.idkey]?(t(),r(le,{key:0,label:"添加时间",prop:"create_time"},{default:s((()=>[i(B,{modelValue:P.model.create_time,"onUpdate:modelValue":l[28]||(l[28]=e=>P.model.create_time=e),disabled:""},null,8,["modelValue"])])),_:1})):c("",!0),P.model[P.idkey]?(t(),r(le,{key:1,label:"修改时间",prop:"update_time"},{default:s((()=>[i(B,{modelValue:P.model.update_time,"onUpdate:modelValue":l[29]||(l[29]=e=>P.model.update_time=e),disabled:""},null,8,["modelValue"])])),_:1})):c("",!0),P.model.delete_time?(t(),r(le,{key:2,label:"删除时间",prop:"delete_time"},{default:s((()=>[i(B,{modelValue:P.model.delete_time,"onUpdate:modelValue":l[30]||(l[30]=e=>P.model.delete_time=e),disabled:""},null,8,["modelValue"])])),_:1})):c("",!0)])),_:1},8,["height"])])),_:1}),i(ne,{label:"内容"},{default:s((()=>[i(ue,{native:"",height:P.height-80},{default:s((()=>[i(le,{label:"内容",prop:"content"},{default:s((()=>[i(ce,{modelValue:P.model.content,"onUpdate:modelValue":l[31]||(l[31]=e=>P.model.content=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["height"])])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title","before-close"])])}]]);export{ee as default};
