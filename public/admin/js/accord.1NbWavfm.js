import{ar as e,ab as l,ac as t,a,c as i,a3 as s,w as o,Q as d,af as r,k as n,a2 as m,j as c,t as u,aa as p,O as h,P as f,ay as g,as as _}from"./index.X-jui3pB.js";import{v as b}from"./el-loading.ZnwTj0hH.js";import{E as y}from"./el-scrollbar.EjLrJKZ7.js";import{_ as V}from"./index.7KFZy18k.js";import{_ as k}from"./index.T-O13tUd.js";import{a as v,b as j}from"./el-table-column.m5n_rNU5.js";import"./el-tooltip.w40geAFS.js";import"./el-popper.2TV6hW8V.js";import{E as q}from"./el-link.K86MkO_X.js";import{a as w,E as C}from"./el-select.IZ2sRcVm.js";import{E as x}from"./el-dialog.GNTN5_Yb.js";import{a as U,E as D}from"./el-form-item.fBV8IyCx.js";import{E as T}from"./el-switch.Fev2IwRl.js";import{E as I}from"./el-row.FTUnHtwG.js";import{E}from"./el-col.QFLVBZWX.js";import{_ as S}from"./index.ZULZm0Vm.js";import{E as A}from"./el-date-picker.ss13QC9x.js";import{s as $}from"./screen-height.gFiksU7H.js";import{h as G}from"./clipboard.-zbfTtbP.js";import{a as O}from"./index.bcmqBeHZ.js";import{g as P}from"./settings.w581UH8z.js";import{_ as Y}from"./_plugin-vue_export-helper.NGi3vMWx.js";import"./index.fg8wy0WZ.js";import"./FilePreview.VFYO2Lgw.js";import"./el-image-viewer.VVqDJJEN.js";import"./debounce.rYA8O6zP.js";import"./el-card.REkhRq4G.js";import"./el-text.Ciquk2iA.js";/* empty css                       */import"./permission.HVxGgwHt.js";import"./group._7hIMa4o.js";import"./tag.Ymwq-8Zh.js";import"./index.bJE25r8Y.js";import"./_Uint8Array.ccUD6PZG.js";import"./index.LgXrDfVM.js";import"./isUndefined.UiWlRqRn.js";import"./refs.GrliRMoI.js";import"./castArray.xoi9qGdq.js";import"./tagsView.XBTTKaFa.js";const z="/admin/setting.Accord/";const F={class:"app-container"},H={class:"c-red"};const R=Y({name:"SettingAccord",components:{Pagination:k,RichEditor:V},data:()=>({name:"协议",height:680,loading:!1,idkey:"accord_id",exps:[{exp:"like",name:"包含"}],query:{page:1,limit:P(),search_field:"name",search_exp:"like",date_field:"create_time"},data:[],count:0,dialog:!1,dialogTitle:"",model:{accord_id:"",unique:"",name:"",desc:"",content:"",remark:"",sort:250},rules:{unique:[{required:!0,message:"请输入标识",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}]},selection:[],selectIds:"",selectTitle:"操作",selectDialog:!1,selectType:"",is_disable:0}),created(){this.height=$(),this.list()},methods:{list(){var l;this.loading=!0,(l=this.query,e({url:z+"list",method:"get",params:l})).then((e=>{this.data=e.data.list,this.count=e.data.count,this.exps=e.data.exps,this.loading=!1})).catch((()=>{this.loading=!1}))},add(){this.dialog=!0,this.dialogTitle=this.name+"添加",this.reset()},edit(l){this.dialog=!0,this.dialogTitle=this.name+"修改："+l[this.idkey];var t,a={};a[this.idkey]=l[this.idkey],(t=a,e({url:z+"info",method:"get",params:t})).then((e=>{this.reset(e.data)})).catch((()=>{}))},cancel(){this.dialog=!1,this.reset()},submit(){this.$refs.ref.validate((t=>{var a;t&&(this.loading=!0,this.model[this.idkey]?(a=this.model,e({url:z+"edit",method:"post",data:a})).then((e=>{this.list(),this.dialog=!1,l.success(e.msg)})).catch((()=>{this.loading=!1})):function(l){return e({url:z+"add",method:"post",data:l})}(this.model).then((e=>{this.list(),this.dialog=!1,l.success(e.msg)})).catch((()=>{this.loading=!1})))}))},reset(e){if(this.model=e||this.$options.data().model,void 0!==this.$refs.ref)try{this.$refs.ref.resetFields(),this.$refs.ref.clearValidate()}catch(l){}},search(){this.query.page=1,this.list()},refresh(){const e=this.query.limit;this.query=this.$options.data().query,this.$refs.table.clearSort(),this.query.limit=e,this.list()},sort(e){this.query.sort_field=e.prop,this.query.sort_value="","ascending"===e.order&&(this.query.sort_value="asc",this.list()),"descending"===e.order&&(this.query.sort_value="desc",this.list())},select(e){this.selection=e,this.selectIds=this.selectGetIds(e).toString()},selectGetIds(e){return O(e,this.idkey)},selectAlert(){t.alert("请选择需要操作的"+this.name,"提示",{type:"warning",callback:()=>{}})},selectOpen(e,l=""){if(l){this.$refs.table.clearSelection();const e=l.length;for(let t=0;t<e;t++)this.$refs.table.toggleRowSelection(l[t],!0)}this.selection.length?(this.selectTitle="操作","disable"===e?this.selectTitle=this.name+"是否禁用":"dele"===e&&(this.selectTitle=this.name+"删除"),this.selectDialog=!0,this.selectType=e):this.selectAlert()},selectCancel(){this.selectDialog=!1},selectSubmit(){if(this.selection.length){const e=this.selectType;"disable"===e?this.disable(this.selection,!0):"dele"===e&&this.dele(this.selection),this.selectDialog=!1}else this.selectAlert()},disable(t,a=!1){if(t.length){this.loading=!0;var i=t[0].is_disable;a&&(i=this.is_disable),(s={ids:this.selectGetIds(t),is_disable:i},e({url:z+"disable",method:"post",data:s})).then((e=>{this.list(),l.success(e.msg)})).catch((()=>{this.list()}))}else this.selectAlert();var s},dele(t){var a;t.length?(this.loading=!0,(a={ids:this.selectGetIds(t)},e({url:z+"dele",method:"post",data:a})).then((e=>{this.list(),l.success(e.msg)})).catch((()=>{this.loading=!1}))):this.selectAlert()},copy(e){G(e)},cellDbclick(e,l){this.copy(e[l.property])}}},[["render",function(e,l,t,$,G,O){const P=w,Y=C,z=g,R=A,M=_,B=S,J=E,Q=I,W=T,K=U,L=D,N=x,X=v,Z=q,ee=j,le=k,te=V,ae=y,ie=b;return a(),i("div",F,[s(Q,null,{default:o((()=>[s(J,{class:"mb-2"},{default:o((()=>[s(Y,{modelValue:G.query.search_field,"onUpdate:modelValue":l[0]||(l[0]=e=>G.query.search_field=e),class:"ya-search-field",placeholder:"查询字段"},{default:o((()=>[s(P,{value:G.idkey,label:"ID"},null,8,["value"]),s(P,{value:"unique",label:"标识"}),s(P,{value:"name",label:"名称"}),s(P,{value:"desc",label:"描述"}),s(P,{value:"remark",label:"备注"}),s(P,{value:"is_disable",label:"禁用"})])),_:1},8,["modelValue"]),s(Y,{modelValue:G.query.search_exp,"onUpdate:modelValue":l[1]||(l[1]=e=>G.query.search_exp=e),class:"ya-search-exp"},{default:o((()=>[(a(!0),i(d,null,r(G.exps,(e=>(a(),n(P,{key:e.exp,value:e.exp,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"]),"is_disable"===G.query.search_field?(a(),n(Y,{key:0,modelValue:G.query.search_value,"onUpdate:modelValue":l[2]||(l[2]=e=>G.query.search_value=e),class:"ya-search-value"},{default:o((()=>[s(P,{value:1,label:"是"}),s(P,{value:0,label:"否"})])),_:1},8,["modelValue"])):(a(),n(z,{key:1,modelValue:G.query.search_value,"onUpdate:modelValue":l[3]||(l[3]=e=>G.query.search_value=e),class:"ya-search-value",placeholder:"查询内容",clearable:""},null,8,["modelValue"])),s(Y,{modelValue:G.query.date_field,"onUpdate:modelValue":l[4]||(l[4]=e=>G.query.date_field=e),class:"ya-date-field",placeholder:"时间类型"},{default:o((()=>[s(P,{value:"create_time",label:"添加时间"}),s(P,{value:"update_time",label:"修改时间"})])),_:1},8,["modelValue"]),s(R,{modelValue:G.query.date_value,"onUpdate:modelValue":l[5]||(l[5]=e=>G.query.date_value=e),type:"datetimerange",class:"ya-date-value","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD HH:mm:ss","default-time":[new Date(2024,1,1,0,0,0),new Date(2024,1,1,23,59,59)]},null,8,["modelValue","default-time"]),s(M,{type:"primary",onClick:l[6]||(l[6]=e=>O.search())},{default:o((()=>[m("查询")])),_:1}),s(M,{title:"重置",onClick:l[7]||(l[7]=e=>O.refresh())},{default:o((()=>[s(B,{"icon-class":"refresh"})])),_:1}),s(M,{type:"primary",onClick:l[8]||(l[8]=e=>O.add())},{default:o((()=>[m("添加")])),_:1})])),_:1})])),_:1}),s(Q,null,{default:o((()=>[s(J,null,{default:o((()=>[s(M,{title:"删除",onClick:l[9]||(l[9]=e=>O.selectOpen("dele"))},{default:o((()=>[m("删除")])),_:1}),s(M,{title:"是否禁用",onClick:l[10]||(l[10]=e=>O.selectOpen("disable"))},{default:o((()=>[m("禁用")])),_:1})])),_:1})])),_:1}),s(N,{modelValue:G.selectDialog,"onUpdate:modelValue":l[13]||(l[13]=e=>G.selectDialog=e),title:G.selectTitle,"close-on-click-modal":!1,"close-on-press-escape":!1,top:"20vh"},{footer:o((()=>[s(M,{loading:G.loading,onClick:O.selectCancel},{default:o((()=>[m("取消")])),_:1},8,["loading","onClick"]),s(M,{loading:G.loading,type:"primary",onClick:O.selectSubmit},{default:o((()=>[m("提交")])),_:1},8,["loading","onClick"])])),default:o((()=>[s(L,{ref:"selectRef","label-width":"120px"},{default:o((()=>["disable"===G.selectType?(a(),n(K,{key:0,label:"是否禁用"},{default:o((()=>[s(W,{modelValue:G.is_disable,"onUpdate:modelValue":l[11]||(l[11]=e=>G.is_disable=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1})):"dele"===G.selectType?(a(),n(K,{key:1},{default:o((()=>[c("span",H,"确定要删除选中的"+u(G.name)+"吗？",1)])),_:1})):p("",!0),s(K,{label:G.name+"ID"},{default:o((()=>[s(z,{modelValue:G.selectIds,"onUpdate:modelValue":l[12]||(l[12]=e=>G.selectIds=e),type:"textarea",autosize:"",disabled:""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},512)])),_:1},8,["modelValue","title"]),h((a(),n(ee,{ref:"table",data:G.data,height:G.height,onSortChange:O.sort,onSelectionChange:O.select,onCellDblclick:O.cellDbclick},{default:o((()=>[s(X,{type:"selection",width:"42",title:"全选/反选"}),s(X,{prop:G.idkey,label:"ID",width:"80",sortable:"custom"},null,8,["prop"]),s(X,{prop:"unique",label:"标识","min-width":"120",sortable:"custom","show-overflow-tooltip":""}),s(X,{prop:"name",label:"名称","min-width":"120",sortable:"custom","show-overflow-tooltip":""}),s(X,{prop:"desc",label:"描述","min-width":"160","show-overflow-tooltip":""}),s(X,{prop:"remark",label:"备注","min-width":"150","show-overflow-tooltip":""}),s(X,{prop:"is_disable",label:"禁用","min-width":"85",sortable:"custom"},{default:o((e=>[s(W,{modelValue:e.row.is_disable,"onUpdate:modelValue":l=>e.row.is_disable=l,"active-value":1,"inactive-value":0,onChange:l=>O.disable([e.row])},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),s(X,{prop:"sort",label:"排序","min-width":"85",sortable:"custom"}),s(X,{prop:"create_time",label:"添加时间",width:"165",sortable:"custom"}),s(X,{prop:"update_time",label:"修改时间",width:"165",sortable:"custom"}),s(X,{label:"操作",width:"95"},{default:o((e=>[s(Z,{type:"primary",class:"mr-1",underline:!1,onClick:l=>O.edit(e.row)},{default:o((()=>[m(" 修改 ")])),_:2},1032,["onClick"]),s(Z,{type:"primary",underline:!1,onClick:l=>O.selectOpen("dele",[e.row])},{default:o((()=>[m(" 删除 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","height","onSortChange","onSelectionChange","onCellDblclick"])),[[ie,G.loading]]),h(s(le,{total:G.count,"onUpdate:total":l[14]||(l[14]=e=>G.count=e),page:G.query.page,"onUpdate:page":l[15]||(l[15]=e=>G.query.page=e),limit:G.query.limit,"onUpdate:limit":l[16]||(l[16]=e=>G.query.limit=e),onPagination:O.list},null,8,["total","page","limit","onPagination"]),[[f,G.count>0]]),s(N,{modelValue:G.dialog,"onUpdate:modelValue":l[27]||(l[27]=e=>G.dialog=e),title:G.dialogTitle,"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":O.cancel,top:"5vh","destroy-on-close":""},{footer:o((()=>[s(M,{loading:G.loading,onClick:O.cancel},{default:o((()=>[m("取消")])),_:1},8,["loading","onClick"]),s(M,{loading:G.loading,type:"primary",onClick:O.submit},{default:o((()=>[m("提交")])),_:1},8,["loading","onClick"])])),default:o((()=>[s(ae,{native:"",height:G.height-30},{default:o((()=>[s(L,{ref:"ref",rules:G.rules,model:G.model,"label-width":"100px"},{default:o((()=>[s(K,{label:"标识",prop:"unique"},{default:o((()=>[s(z,{modelValue:G.model.unique,"onUpdate:modelValue":l[18]||(l[18]=e=>G.model.unique=e),placeholder:"请输入标识（唯一）",clearable:""},{append:o((()=>[s(M,{title:"复制",onClick:l[17]||(l[17]=e=>O.copy(G.model.unique))},{default:o((()=>[s(B,{"icon-class":"copy-document"})])),_:1})])),_:1},8,["modelValue"])])),_:1}),s(K,{label:"名称",prop:"name"},{default:o((()=>[s(z,{modelValue:G.model.name,"onUpdate:modelValue":l[20]||(l[20]=e=>G.model.name=e),placeholder:"请输入名称",clearable:""},{append:o((()=>[s(M,{title:"复制",onClick:l[19]||(l[19]=e=>O.copy(G.model.name))},{default:o((()=>[s(B,{"icon-class":"copy-document"})])),_:1})])),_:1},8,["modelValue"])])),_:1}),s(K,{label:"描述",prop:"desc"},{default:o((()=>[s(z,{modelValue:G.model.desc,"onUpdate:modelValue":l[21]||(l[21]=e=>G.model.desc=e),type:"textarea",autosize:"",placeholder:"请输入描述"},null,8,["modelValue"])])),_:1}),s(K,{label:"备注",prop:"remark"},{default:o((()=>[s(z,{modelValue:G.model.remark,"onUpdate:modelValue":l[22]||(l[22]=e=>G.model.remark=e),placeholder:"请输入备注",clearable:""},null,8,["modelValue"])])),_:1}),s(K,{label:"排序",prop:"sort"},{default:o((()=>[s(z,{modelValue:G.model.sort,"onUpdate:modelValue":l[23]||(l[23]=e=>G.model.sort=e),type:"number"},null,8,["modelValue"])])),_:1}),s(K,{label:"内容",prop:"content"},{default:o((()=>[s(te,{content:G.model.content},null,8,["content"])])),_:1}),G.model[G.idkey]?(a(),n(K,{key:0,label:"添加时间",prop:"create_time"},{default:o((()=>[s(z,{modelValue:G.model.create_time,"onUpdate:modelValue":l[24]||(l[24]=e=>G.model.create_time=e),disabled:""},null,8,["modelValue"])])),_:1})):p("",!0),G.model[G.idkey]?(a(),n(K,{key:1,label:"修改时间",prop:"update_time"},{default:o((()=>[s(z,{modelValue:G.model.update_time,"onUpdate:modelValue":l[25]||(l[25]=e=>G.model.update_time=e),disabled:""},null,8,["modelValue"])])),_:1})):p("",!0),G.model.delete_time?(a(),n(K,{key:2,label:"删除时间",prop:"delete_time"},{default:o((()=>[s(z,{modelValue:G.model.delete_time,"onUpdate:modelValue":l[26]||(l[26]=e=>G.model.delete_time=e),disabled:""},null,8,["modelValue"])])),_:1})):p("",!0)])),_:1},8,["rules","model"])])),_:1},8,["height"])])),_:1},8,["modelValue","title","before-close"])])}]]);export{R as default};
