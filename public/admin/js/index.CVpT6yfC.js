import{b as e,g as t,aR as o,aV as a,cA as l,d as n,u as r,aW as i,d4 as u,d5 as s,r as d,C as f,aE as c,J as p,o as v,F as m,bF as g,az as h,U as y,a as w,c as b,j as _,e as x,n as C,f as $,am as E,_ as O,q as j,cp as V,d6 as S,d7 as A,d8 as F,d9 as P,da as N,a5 as B,db as U,dc as I,K as T,a2 as z,w as D,bU as H}from"./index.DjA_re4j.js";import{E as M}from"./el-dialog.yRJSSox7.js";import{F as k}from"./index.De39iDjm.js";const L=e({zIndex:{type:t([Number,String]),default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),J={scroll:({scrollTop:e,fixed:t})=>o(e)&&a(t),[l]:e=>a(e)},q="ElAffix",K=n({name:q});const R=j(O(n({...K,props:L,emits:J,setup(e,{expose:t,emit:o}){const a=e,l=r("affix"),n=i(),O=i(),j=i(),{height:V}=u(),{height:S,width:A,top:F,bottom:P,update:N}=s(O,{windowScroll:!1}),B=s(n),U=d(!1),I=d(0),T=d(0),z=f((()=>({height:U.value?`${S.value}px`:"",width:U.value?`${A.value}px`:""}))),D=f((()=>{if(!U.value)return{};const e=a.offset?c(a.offset):0;return{height:`${S.value}px`,width:`${A.value}px`,top:"top"===a.position?e:"",bottom:"bottom"===a.position?e:"",transform:T.value?`translateY(${T.value}px)`:"",zIndex:a.zIndex}})),H=()=>{if(j.value)if(I.value=j.value instanceof Window?document.documentElement.scrollTop:j.value.scrollTop||0,"top"===a.position)if(a.target){const e=B.bottom.value-a.offset-S.value;U.value=a.offset>F.value&&B.bottom.value>0,T.value=e<0?e:0}else U.value=a.offset>F.value;else if(a.target){const e=V.value-B.top.value-a.offset-S.value;U.value=V.value-a.offset<P.value&&V.value>B.top.value,T.value=e<0?-e:0}else U.value=V.value-a.offset<P.value};return p(U,(e=>o("change",e))),v((()=>{var e;a.target?(n.value=null!=(e=document.querySelector(a.target))?e:void 0,n.value||m(q,`Target is not existed: ${a.target}`)):n.value=document.documentElement,j.value=g(O.value,!0),N()})),h(j,"scroll",(()=>{N(),o("scroll",{scrollTop:I.value,fixed:U.value})})),y(H),t({update:H,updateRoot:N}),(e,t)=>(w(),b("div",{ref_key:"root",ref:O,class:C($(l).b()),style:E($(z))},[_("div",{class:C({[$(l).m("fixed")]:U.value}),style:E($(D))},[x(e.$slots,"default")],6)],6))}}),[["__file","affix.vue"]]));var W=Object.defineProperty,Y=Object.defineProperties,G=Object.getOwnPropertyDescriptors,Q=Object.getOwnPropertySymbols,X=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable,ee=(e,t,o)=>t in e?W(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,te=(e,t)=>{for(var o in t||(t={}))X.call(t,o)&&ee(e,o,t[o]);if(Q)for(var o of Q(t))Z.call(t,o)&&ee(e,o,t[o]);return e};function oe(e){let t=`请使用 '@${e}' 事件，不要放在 props 中`;return t+=`\nPlease use '@${e}' event instead of props`,t}var ae=(e,t)=>{for(const[o,a]of t)e[o]=a;return e};const le=n({props:{mode:{type:String,default:"default"},defaultContent:{type:Array,default:[]},defaultHtml:{type:String,default:""},defaultConfig:{type:Object,default:{}},modelValue:{type:String,default:""}},setup(e,t){const o=d(null),a=i(null),l=d("");return v((()=>{(()=>{if(!o.value)return;const n=V(e.defaultContent);var r,i;S({selector:o.value,mode:e.mode,content:n||[],html:e.defaultHtml||e.modelValue||"",config:(r=te({},e.defaultConfig),i={onCreated(o){if(a.value=o,t.emit("onCreated",o),e.defaultConfig.onCreated){const e=oe("onCreated");throw new Error(e)}},onChange(o){const a=o.getHtml();if(l.value=a,t.emit("update:modelValue",a),t.emit("onChange",o),e.defaultConfig.onChange){const e=oe("onChange");throw new Error(e)}},onDestroyed(o){if(t.emit("onDestroyed",o),e.defaultConfig.onDestroyed){const e=oe("onDestroyed");throw new Error(e)}},onMaxLength(o){if(t.emit("onMaxLength",o),e.defaultConfig.onMaxLength){const e=oe("onMaxLength");throw new Error(e)}},onFocus(o){if(t.emit("onFocus",o),e.defaultConfig.onFocus){const e=oe("onFocus");throw new Error(e)}},onBlur(o){if(t.emit("onBlur",o),e.defaultConfig.onBlur){const e=oe("onBlur");throw new Error(e)}},customAlert(o,a){if(t.emit("customAlert",o,a),e.defaultConfig.customAlert){const e=oe("customAlert");throw new Error(e)}},customPaste:(o,a)=>{if(e.defaultConfig.customPaste){const e=oe("customPaste");throw new Error(e)}let l;return t.emit("customPaste",o,a,(e=>{l=e})),l}},Y(r,G(i)))})})()})),p((()=>e.modelValue),(e=>{e!==l.value&&function(e){const t=a.value;if(null==t)return;const o=t.isDisabled(),l=t.isFocused(),n=JSON.stringify(t.selection);if(t.enable(),t.focus(),t.select([]),t.deleteFragment(),A.setNodes(t,{type:"paragraph"},{mode:"highest"}),t.dangerouslyInsertHtml(e),!l)return t.deselect(),void t.blur();if(o)return t.deselect(),void t.disable();try{t.select(JSON.parse(n))}catch(r){t.select(F.start(t,[]))}}(e)})),{box:o}}}),ne={ref:"box",style:{height:"100%"}};var re=ae(le,[["render",function(e,t,o,a,l,n){return w(),b("div",ne,null,512)}]]);const ie=n({props:{editor:{type:Object},mode:{type:String,default:"default"},defaultConfig:{type:Object,default:{}}},setup(e){const t=d(null);return y((()=>{const{editor:o}=e;null!=o&&(o=>{if(t.value){if(null==o)throw new Error("Not found instance of Editor when create <Toolbar/> component");P.getToolbar(o)||N({editor:o,selector:t.value||"<div></div>",mode:e.mode,config:e.defaultConfig})}})(o)})),{selector:t}}}),ue={ref:"selector"};var se=ae(ie,[["render",function(e,t,o,a,l,n){return w(),b("div",ue,null,512)}]]);const de={class:"editor-wrapper"},fe={__name:"index",props:{modelValue:{type:[String],default:""}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,a=B(),l=t;U("zh-cn"==a.language?"zh-CN":"en");const n=I(o,"modelValue",l),r=i(),u=d("default"),s=d({insertKeys:{index:24,keys:["uploadAttachment"]}}),f=d({placeholder:"请输入内容...",MENU_CONF:{uploadImage:{customBrowseAndUpload(){v.value=!0,g.value="image"}},uploadVideo:{customBrowseAndUpload(){v.value=!0,g.value="video"}},uploadAttachment:{customBrowseAndUpload(){v.value=!0,g.value="word"}}}}),c=e=>{r.value=e};function p(e){n.value=e.getHtml()}const v=d(!1),m=d("文件管理"),g=d("image");function h(){v.value=!1}function y(e){v.value=!1;var t="";const o=e.length;for(let a=0;a<o;a++)"image"===e[a].file_type?t+=`<img file-id="${e[a].file_id}" src="${e[a].file_url}" style="width:640px;"/>`:"video"===e[a].file_type?t+=`<div data-w-e-type="video" data-w-e-is-void><video width="640" height="480" controls>\n                <source file-id="${e[a].file_id}" src="${e[a].file_url}" type="video/mp4">\n                <object file-id="${e[a].file_id}" data="${e[a].file_url}">\n                  <embed file-id="${e[a].file_id}" src="${e[a].file_url}" width="640" height="480">\n                </object>\n              </video></div>`:"audio"===e[a].file_type?t+=`<div data-w-e-type="audio" data-w-e-is-void data-w-e-is-inline><audio controls>\n                <source file-id="${e[a].file_id}" src="${e[a].file_url}" type="audio/mp3">\n                <embed file-id="${e[a].file_id}" src="${e[a].file_url}">\n              </audio></div>`:t+=`<div data-w-e-type="attachment" data-w-e-is-void data-w-e-is-inline><a file-id="${e[a].file_id}" href="${e[a].file_url}" download="${e[a].file_url}" target="_blank">${e[a].file_name}.${e[a].file_ext}</a></div>`;r.value.dangerouslyInsertHtml(t)}return T((()=>{const e=r.value;null!=e&&e.destroy()})),(e,t)=>{const o=R,a=M;return w(),b("div",de,[z(o,{target:".editor-wrapper",offset:150},{default:D((()=>[z($(se),{id:"toolbar-container",editor:$(r),"default-config":$(s),mode:$(u)},null,8,["editor","default-config","mode"])])),_:1}),z($(re),{id:"editor-container",modelValue:$(n),"onUpdate:modelValue":t[0]||(t[0]=e=>H(n)?n.value=e:null),"default-config":$(f),mode:$(u),onOnChange:p,onOnCreated:c},null,8,["modelValue","default-config","mode"]),z(a,{modelValue:$(v),"onUpdate:modelValue":t[1]||(t[1]=e=>H(v)?v.value=e:null),title:$(m),"close-on-click-modal":!1,"close-on-press-escape":!1,top:"1vh",width:"80%","append-to-body":""},{default:D((()=>[z(k,{"file-type":$(g),onFileCancel:h,onFileSubmit:y},null,8,["file-type"])])),_:1},8,["modelValue","title"])])}}};export{fe as _};
